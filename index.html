<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Cromos de F√∫tbol</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- LOGIN/REGISTER SCREEN -->
    <section id="loginScreen" class="login-screen active">
        <div class="login-container">
            <div class="login-header">
                <div class="login-icon">‚öΩ</div>
                <h1>Gestor de Cromos</h1>
                <p>Organiza tu colecci√≥n de cromos de f√∫tbol</p>
            </div>
            
            <!-- LOGIN FORM -->
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required placeholder="tu@email.com" autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Contrase√±a</label>
                    <input type="password" id="loginPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                    Iniciar Sesi√≥n üöÄ
                </button>
            </form>
            
            <!-- REGISTER FORM -->
            <form id="registerForm" class="auth-form hidden">
                <div class="form-group">
                    <label for="registerName">Nombre</label>
                    <input type="text" id="registerName" required placeholder="Tu nombre" autocomplete="name">
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" required placeholder="tu@email.com" autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="registerPassword">Contrase√±a</label>
                    <input type="password" id="registerPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password" minlength="6">
                    <small>M√≠nimo 6 caracteres</small>
                </div>
                <div class="form-group">
                    <label for="registerPasswordConfirm">Confirmar Contrase√±a</label>
                    <input type="password" id="registerPasswordConfirm" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                    Registrarse ‚ú®
                </button>
            </form>
            
            <!-- TOGGLE BUTTON -->
            <div style="text-align: center; margin-top: 1.5rem;">
                <button id="toggleAuthMode" class="btn-link">
                    ¬øNo tienes cuenta? Reg√≠strate
                </button>
            </div>
        </div>
    </section>

    <!-- MAIN APP -->
    <div id="mainApp" class="hidden">
        <!-- HEADER -->
        <header class="app-header">
            <div class="container">
                <div class="header-left">
                    <h1>‚öΩ Gestor de Cromos</h1>
                </div>
                <div class="header-right">
                    <div class="user-menu">
                        <div class="user-photo" id="userAvatar"></div>
                        <span id="userNameDisplay" class="user-name"></span>
                        <button id="btnLogout" class="btn-logout">Salir</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- MAIN CONTENT -->
        <main class="container">
            <!-- VIEW: ALBUMS LIST -->
            <section id="viewAlbums" class="view active">
                <div class="view-header">
                    <h2>Mis √Ålbumes</h2>
                    <div class="actions">
                        <button id="btnNewAlbum" class="btn btn-primary">+ Nuevo √Ålbum</button>
                    </div>
                </div>
                <div class="filters-bar">
                    <input type="text" id="filterAlbumSearch" placeholder="üîç Buscar √°lbum..." class="filter-input">
                </div>
                <div id="albumsGrid" class="albums-grid"></div>
            </section>

            <!-- VIEW: ALBUM DETAIL -->
            <section id="viewAlbumDetail" class="view">
                <div class="view-header">
                    <button id="btnBackToAlbums" class="btn-back">‚Üê Volver</button>
                    <div class="album-info">
                        <h2 id="albumTitle"></h2>
                        <p id="albumMeta"></p>
                    </div>
                    <div class="actions">
                        <button id="btnManageCategories" class="btn btn-secondary">üìÇ Categor√≠as</button>
                        <button id="btnEditAlbum" class="btn-icon" title="Editar">‚úèÔ∏è</button>
                        <button id="btnDeleteAlbum" class="btn-icon" title="Eliminar">üóëÔ∏è</button>
                    </div>
                </div>

                <div class="stats-bar">
                    <div class="stat">
                        <span class="stat-label">Total</span>
                        <span id="statTotal" class="stat-value">0</span>
                    </div>
                    <div class="stat stat-tengo">
                        <span class="stat-label">Tengo</span>
                        <span id="statTengo" class="stat-value">0</span>
                    </div>
                    <div class="stat stat-falta">
                        <span class="stat-label">Faltan</span>
                        <span id="statFalta" class="stat-value">0</span>
                    </div>
                    <div class="stat stat-repetido">
                        <span class="stat-label">Repetidos</span>
                        <span id="statRepetido" class="stat-value">0</span>
                    </div>
                </div>

                <div class="toolbar">
                    <button id="btnNewCard" class="btn btn-primary">+ A√±adir Cromo</button>
                    <button id="btnViewFalta" class="btn btn-outline">üìã Faltan</button>
                    <button id="btnViewRepetido" class="btn btn-outline">üìã Repetidos</button>
                    <button id="btnToggleView" class="btn btn-secondary">üîÑ Vista √Ålbum</button>
                    <button id="btnToggleGrouping" class="btn btn-secondary">üìÅ Agrupar</button>
                    <button id="btnImport" class="btn btn-secondary">üì• Importar</button>
                    <button id="btnExport" class="btn btn-secondary">üì§ Exportar</button>
                </div>
                
                <div class="filters-bar">
                    <input type="text" id="filterSearch" placeholder="üîç Buscar por jugador..." class="filter-input">
                    <select id="filterTeam" class="filter-select">
                        <option value="">Todos los equipos</option>
                    </select>
                    <select id="filterCategory" class="filter-select">
                        <option value="">Todas las categor√≠as</option>
                    </select>
                    <select id="filterStatus" class="filter-select">
                        <option value="">Todos los estados</option>
                        <option value="tengo">Tengo</option>
                        <option value="falta">Faltan</option>
                        <option value="repetido">Repetidos</option>
                    </select>
                    <button id="btnClearFilters" class="btn-icon" title="Limpiar filtros">üîÑ</button>
                </div>

                <div id="cardsGrid" class="cards-list"></div>
            </section>
        </main>

        <!-- MODALS -->
        <div id="modalAlbum" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalAlbumTitle">Nuevo √Ålbum</h3>
                    <button class="btn-close" data-close="modalAlbum">√ó</button>
                </div>
                <div class="modal-body">
                    <form id="formAlbum">
                        <div class="form-group">
                            <label for="albumName">Nombre *</label>
                            <input type="text" id="albumName" required>
                        </div>
                        <div class="form-group">
                            <label for="albumColor">Color del √°lbum</label>
                            <input type="color" id="albumColor" value="#10B981">
                        </div>
                        <div class="form-group">
                            <label for="albumSeason">Temporada</label>
                            <input type="text" id="albumSeason" placeholder="Ej: 2023-2024">
                        </div>
                        <div class="form-group">
                            <label for="albumCompetition">Competici√≥n</label>
                            <input type="text" id="albumCompetition" placeholder="Ej: LaLiga">
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-secondary" data-close="modalAlbum">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Guardar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="modalCard" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalCardTitle">Nuevo Cromo</h3>
                    <button class="btn-close" data-close="modalCard">√ó</button>
                </div>
                <div class="modal-body">
                    <form id="formCard">
                        <div class="form-group">
                            <label for="cardNumber">N√∫mero</label>
                            <input type="text" id="cardNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="cardPlayer">Jugador *</label>
                            <input type="text" id="cardPlayer" required>
                        </div>
                        <div class="form-group">
                            <label for="cardTeam">Equipo *</label>
                            <input type="text" id="cardTeam" required>
                        </div>
                        <div class="form-group">
                            <label for="cardCategory">Categor√≠a *</label>
                            <select id="cardCategory" required></select>
                        </div>
                        <div class="form-group">
                            <label for="cardStatus">Estado</label>
                            <select id="cardStatus">
                                <option value="falta">Falta</option>
                                <option value="tengo">Tengo</option>
                                <option value="cambiado">Cambiado</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="cardDuplicates">Repetidos (cantidad)</label>
                            <input type="number" id="cardDuplicates" min="0" value="0">
                        </div>
                        <div class="modal-actions">
                            <button type="button" id="btnDeleteCard" class="btn btn-outline hidden" style="margin-right: auto;">Eliminar</button>
                            <button type="button" class="btn btn-secondary" data-close="modalCard">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Guardar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="modalCategories" class="modal">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h3>Gesti√≥n de Categor√≠as</h3>
                    <button class="btn-close" data-close="modalCategories">√ó</button>
                </div>
                <div class="modal-body">
                    <form id="formCategory" class="inline-form">
                        <input type="text" id="categoryName" placeholder="Nombre categor√≠a" required>
                        <input type="color" id="categoryColor" value="#10B981">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="categoryIsBasic"> B√°sica
                        </label>
                        <button type="submit" class="btn btn-primary">+ A√±adir</button>
                    </form>
                    <div id="categoriesList" class="categories-list"></div>
                    
                    <!-- Modal para editar categor√≠a -->
                    <div id="editCategorySection" class="edit-section hidden">
                        <h4>Editar Categor√≠a</h4>
                        <form id="formEditCategory" class="inline-form">
                            <input type="text" id="editCategoryName" required>
                            <input type="color" id="editCategoryColor">
                            <button type="submit" class="btn btn-primary">Guardar</button>
                            <button type="button" id="btnCancelEditCategory" class="btn btn-secondary">Cancelar</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div id="modalCardList" class="modal">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h3 id="modalCardListTitle">Cromos</h3>
                    <button class="btn-close" data-close="modalCardList">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="view-toggle" style="margin-bottom: 1rem;">
                        <button id="btnViewText" class="btn btn-sm active">üìù Texto</button>
                        <button id="btnViewGrouped" class="btn btn-sm">üìä Agrupado</button>
                    </div>
                    
                    <div id="viewTextContent" class="view-content active">
                        <button id="btnCopyText" class="btn btn-outline" style="margin-bottom: 1rem;">üìã Copiar todos</button>
                        <div id="textListContent" class="text-list"></div>
                    </div>
                    
                    <div id="viewGroupedContent" class="view-content">
                        <div class="filters-bar" style="margin-bottom: 1rem;">
                            <select id="filterListCategory" class="filter-select">
                                <option value="">Todas las categor√≠as</option>
                            </select>
                        </div>
                        <div id="groupedListContent"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="modalImport" class="modal">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h3>Importar Cromos</h3>
                    <button class="btn-close" data-close="modalImport">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Formato</label>
                        <select id="importFormat">
                            <option value="json">JSON</option>
                            <option value="csv">CSV</option>
                            <option value="txt">TXT</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Archivo o Texto</label>
                        <input type="file" id="importFile" accept=".json,.csv,.txt">
                        <textarea id="importText" rows="10" placeholder="O pega aqu√≠ el contenido..."></textarea>
                    </div>
                    <div class="help-text">
                        <strong>JSON:</strong> [{"number":"1","playerName":"Courtois","team":"Real Madrid","categoryId":1,"status":"tengo","duplicatesCount":2}]<br>
                        <strong>CSV:</strong> number,playerName,team,categoryId,status,duplicatesCount<br>
                        <strong>TXT:</strong> 1|Courtois|Real Madrid|1|tengo|2
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" data-close="modalImport">Cancelar</button>
                        <button type="button" id="btnProcessImport" class="btn btn-primary">Importar</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="modalExport" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Exportar √Ålbum</h3>
                    <button class="btn-close" data-close="modalExport">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Formato</label>
                        <select id="exportFormat">
                            <option value="json">JSON</option>
                            <option value="csv">CSV</option>
                            <option value="txt">TXT</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" data-close="modalExport">Cancelar</button>
                        <button type="button" id="btnProcessExport" class="btn btn-primary">Descargar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="loader" class="loader hidden">
        <div class="spinner"></div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>